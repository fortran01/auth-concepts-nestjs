<div class="row">
    <div class="col-md-10 offset-md-1">
        <div class="card">
            <div class="card-header">
                <h2 class="text-center">Authentication Concepts Demo</h2>
            </div>
            <div class="card-body">
                <p class="lead text-center">
                    This application demonstrates different authentication concepts in a NestJS app.
                </p>
                
                <div class="row mt-4">
                    <div class="col-md-3">
                        <div class="card mb-4 h-100">
                            <div class="card-header bg-primary text-white">
                                <h3 class="mb-0">Stateful Authentication</h3>
                            </div>
                            <div class="card-body">
                                <p>Demonstration of server-side sessions stored in Redis.</p>
                                <ul>
                                    <li>Session data stored on server</li>
                                    <li>Only session ID stored in client cookie</li>
                                    <li>Includes Multi-Factor Authentication</li>
                                    <li>Server maintains state</li>
                                </ul>
                                <div class="d-grid gap-2">
                                    <a href="/auth/session/login" class="btn btn-primary">Try Session Login</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="card mb-4 h-100">
                            <div class="card-header bg-secondary text-white">
                                <h3 class="mb-0">Auth0 Universal Login</h3>
                            </div>
                            <div class="card-body">
                                <p>Demonstration of Auth0 Universal Login integration.</p>
                                <ul>
                                    <li>IDaaS (Identity as a Service)</li>
                                    <li>OpenID Connect (OIDC) flow</li>
                                    <li>Centralized user management</li>
                                    <li>Social and enterprise options</li>
                                </ul>
                                <div class="d-grid gap-2">
                                    <a href="/auth0/login" class="btn btn-secondary">Try Auth0 Login</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="card mb-4 h-100">
                            <div class="card-header bg-success text-white">
                                <h3 class="mb-0">Stateless Authentication</h3>
                            </div>
                            <div class="card-body">
                                <p>Demonstration of JWT token-based authentication.</p>
                                <ul>
                                    <li>All session data stored in token</li>
                                    <li>Token stored in browser's localStorage</li>
                                    <li>No MFA (simplified for demo)</li>
                                    <li>Server is stateless</li>
                                </ul>
                                <div class="d-grid gap-2">
                                    <a href="/token/login" class="btn btn-success">Try Token Login</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="card mb-4 h-100">
                            <div class="card-header bg-info text-white">
                                <h3 class="mb-0">LDAP Authentication</h3>
                            </div>
                            <div class="card-body">
                                <p>Direct authentication against an LDAP directory.</p>
                                <ul>
                                    <li>Authenticates directly against OpenLDAP</li>
                                    <li>No MFA (direct LDAP only)</li>
                                    <li>Employee directory integration</li>
                                    <li>Shows DN binding and user attributes</li>
                                </ul>
                                <div class="d-grid gap-2">
                                    <a href="/auth/ldap" class="btn btn-info">Try LDAP Login</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h4>Security Features</h4>
                    <p>This demo also includes various security concepts and demonstrations:</p>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3 auth-feature-card">
                                <div class="card-header bg-warning text-dark">
                                    <h5 class="mb-0">CORS Demo</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">Learn about Cross-Origin Resource Sharing and browser's Same-Origin Policy.</p>
                                    <ul>
                                        <li>Understand how CORS works</li>
                                        <li>See preflight requests in action</li>
                                        <li>Learn different CORS configurations</li>
                                        <li>Experience browser security firsthand</li>
                                    </ul>
                                    <a href="/cors-demo/info" class="btn btn-warning">CORS Demo</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3 auth-feature-card">
                                <div class="card-header bg-danger text-white">
                                    <h5 class="mb-0">CSRF Demo</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">Understand Cross-Site Request Forgery attacks and prevention.</p>
                                    <ul>
                                        <li>See how CSRF attacks work</li>
                                        <li>Learn how to implement CSRF tokens</li>
                                        <li>Understand same-origin policy implications</li>
                                        <li>Experience CSRF protection in action</li>
                                    </ul>
                                    <a href="/csrf-demo" class="btn btn-danger">CSRF Demo</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h4>API Endpoints</h4>
                    <p>The following API endpoints are available for testing:</p>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Endpoint</th>
                                    <th>Method</th>
                                    <th>Authentication</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>/</code></td>
                                    <td>GET</td>
                                    <td>None</td>
                                    <td>Home page (this page)</td>
                                </tr>
                                <tr>
                                    <td><code>/auth/basic</code></td>
                                    <td>GET</td>
                                    <td>Basic Auth</td>
                                    <td>Protected endpoint using Basic Authentication</td>
                                </tr>
                                <tr>
                                    <td><code>/auth/digest</code></td>
                                    <td>GET</td>
                                    <td>Digest Auth</td>
                                    <td>Protected endpoint using Digest Authentication</td>
                                </tr>
                                <tr>
                                    <td><code>/token/login</code></td>
                                    <td>POST</td>
                                    <td>JWT Token</td>
                                    <td>Get JWT token using username/password</td>
                                </tr>
                                <tr>
                                    <td><code>/token/data</code></td>
                                    <td>GET</td>
                                    <td>JWT Token</td>
                                    <td>Protected API endpoint requiring JWT token</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h4>Testing Authentication Endpoints</h4>
                    
                    <h5>Basic Authentication</h5>
                    <p>You can test the Basic Authentication endpoint using curl:</p>
                    <div class="bg-light p-3 rounded">
                        <pre>curl -v -u admin:secret http://localhost:3000/auth/basic</pre>
                    </div>
                    
                    <h5 class="mt-3">Digest Authentication</h5>
                    <p>Testing Digest Authentication requires multiple steps:</p>
                    <div class="bg-light p-3 rounded">
                        <pre>curl -v --digest -u admin:secret http://localhost:3000/auth/digest</pre>
                    </div>
                    <p class="mt-2"><small>Note: The <code>--digest</code> flag tells curl to handle the challenge-response mechanism automatically.</small></p>
                    
                    <h5 class="mt-3">JWT Token Authentication</h5>
                    <p>Testing JWT Token Authentication with curl:</p>
                    <div class="bg-light p-3 rounded">
                        <pre>
# First, get a token
TOKEN=$(curl -s -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"secret"}' http://localhost:3000/token/login | jq -r '.access_token')

# Then use the token to access protected resources
curl -H "Authorization: Bearer $TOKEN" http://localhost:3000/token/data</pre>
                    </div>
                    
                    <p class="mt-2">Default credentials for all authentication methods:</p>
                    <ul>
                        <li>Username: <code>admin</code></li>
                        <li>Password: <code>secret</code></li>
                    </ul>
                </div>
                
                <div class="mt-4">
                    <h4>Debug Tools</h4>
                    <p>Development-only tools for debugging and inspection:</p>
                    <div class="bg-light p-3 rounded">
                        <a href="/debug-tools" class="btn btn-outline-danger">Access Debug Tools</a>
                    </div>
                    <p class="mt-2"><small>Warning: These tools expose sensitive information and should only be used during development.</small></p>
                </div>
            </div>
            <div class="card-footer text-muted">
                <p class="mb-0 text-center">This is an educational demo. <strong>Do not use in production</strong> without proper security review.</p>
            </div>
        </div>
    </div>
</div>
