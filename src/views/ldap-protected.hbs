<div class="row">
    <div class="col-md-8 offset-md-2">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h2>LDAP Authentication Successful</h2>
            </div>
            <div class="card-body">
                <div class="alert alert-success" role="alert">
                    <h4 class="alert-heading">Authentication Successful!</h4>
                    <p>{{message}}</p>
                    <hr>
                    <p class="mb-0">You have been authenticated directly against the LDAP server.</p>
                </div>

                <div class="my-4">
                    <h4>How LDAP Authentication Works</h4>
                    <p>This implementation uses direct authentication with an LDAP server:</p>
                    <ol>
                        <li>Your credentials were sent to the application</li>
                        <li>The application attempted to bind to the LDAP server using your user DN and password</li>
                        <li>If the bind was successful, your LDAP attributes were retrieved</li>
                        <li>Your credentials were never stored in the application</li>
                    </ol>
                </div>

                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h4 class="mb-0">Your LDAP User Information</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <tbody>
                                    <tr>
                                        <th>Distinguished Name (DN)</th>
                                        <td>{{user.dn}}</td>
                                    </tr>
                                    <tr>
                                        <th>Username (uid)</th>
                                        <td>{{user.uid}}</td>
                                    </tr>
                                    <tr>
                                        <th>Full Name (cn)</th>
                                        <td>{{user.cn}}</td>
                                    </tr>
                                    <tr>
                                        <th>First Name (givenName)</th>
                                        <td>{{user.givenName}}</td>
                                    </tr>
                                    <tr>
                                        <th>Last Name (sn)</th>
                                        <td>{{user.sn}}</td>
                                    </tr>
                                    <tr>
                                        <th>Email (mail)</th>
                                        <td>{{user.mail}}</td>
                                    </tr>
                                    <tr>
                                        <th>Job Title (title)</th>
                                        <td>{{user.title}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <div class="alert alert-secondary">
                                <h5>Fields Used in LDAP Setup:</h5>
                                <ul>
                                    <li><strong>uid</strong>: User identifier (e.g., john.doe)</li>
                                    <li><strong>cn</strong>: Common Name - full name (e.g., John Doe)</li>
                                    <li><strong>sn</strong>: Surname - last name (e.g., Doe)</li>
                                    <li><strong>givenName</strong>: First name (e.g., John)</li>
                                    <li><strong>mail</strong>: Email address (e.g., john.doe@example.org)</li>
                                    <li><strong>title</strong>: Job title (e.g., Software Engineer)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h4 class="mb-0">LDAP Authentication Security Considerations</h4>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li><strong>Transport Security:</strong> In a production environment, always use LDAPS (LDAP over SSL/TLS) to encrypt credentials in transit.</li>
                            <li><strong>Connection Pooling:</strong> For production, implement connection pooling to improve performance.</li>
                            <li><strong>Least Privilege:</strong> Use service accounts with minimal necessary permissions for directory operations.</li>
                            <li><strong>Rate Limiting:</strong> Implement rate limiting to prevent brute force attacks.</li>
                            <li><strong>Logging:</strong> Maintain detailed logs of authentication attempts for security monitoring.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-between">
                    <a href="/" class="btn btn-outline-secondary">Back to Home</a>
                    <a href="/auth/ldap/logout" class="btn btn-danger">Logout</a>
                </div>
            </div>
        </div>
    </div>
</div> 